spd
spd = cbind(spd,pt = spd$Dt/spd$Nt)
spd
sum(spd$pt)/length(spd$year)
spd = cbind(spd,p2 = (spd$Dt*(spd$Dt-1))/(spd$Nt*(spd$Nt-1)))
spd
sum(spd$p2)/length(spd$year)
d <- 1
d
d <- quantile(sum(spd$pt)/length(spd$year))
d <- quantile(sum(spd$pt)/length(spd$year))
d
d <- qnorm(sum(spd$pt)/length(spd$year))
d
library(rootSolve)
install.packages(rootSolve)
install.packages("rootSolve")
library(rootSolve)
install.packages("pbvnorm")
install.packages("pbivnorm")
spd <- read.csv('spd.csv')
spd <- data.frame(
year = spd$year.t,
Dt = spd$X..defaults..Dt.,
Nt = spd$X..obligors..Nt.
)
spd
spd = cbind(spd,pt = spd$Dt/spd$Nt)
spd
average_default_prob <- sum(spd$pt)/length(spd$year)
average_default_prob
spd = cbind(spd,p2 = (spd$Dt*(spd$Dt-1))/(spd$Nt*(spd$Nt-1)))
spd
average_joint_default_prob <- sum(spd$p2)/length(spd$year)
average_joint_default_prob
library(pbivnorm)
pbivnorm(d,d,average_joint_default_prob)
library(rootSolve)
library(pbivnorm)
library(rootSolve)
library(pbivnorm)
f <- function(rho){pbivnorm(d,d,rho) - average_joint_default_prob}
uniroot(f,0,1)
library(rootSolve)
library(pbivnorm)
f <- function(rho){pbivnorm(d,d,rho) - average_joint_default_prob}
uniroot(f,c(0,1))
library(rootSolve)
library(pbivnorm)
f <- function(rho){pbivnorm(d,d,rho) - average_joint_default_prob}
uniroot(f,c(0,1))$root
lgd <- as.data.frame(read.csv('lgd.csv'))
lgd
View(lgd)
mean_LGD_for_data <- as.data.frame(read.table('Mean_LGD_for_data_until.txt'))
mean_LGD_for_data <- read.table('Mean_LGD_for_data_until.txt')
mean_LGD_for_data <- read.table('Mean_LGD_for_data_until.txt')
mean_LGD_for_data <- as.data.frame(
cbind(
c(Indsutry, 'Sr. Sec.', 'Sr. Unsec.', 'Sr. Sub.' ,'Sub.')),
c(2006,0.457 ,0.626, 0.672, 0.685),
c(2007, 0.482, 0.636, 0.681, 0.711),
c(2008, 0.365, 0.538, 0.703, 0.712)
)
mean_LGD_for_data <- as.data.frame(
cbind(
c('Indsutry', 'Sr. Sec.', 'Sr. Unsec.', 'Sr. Sub.' ,'Sub.')),
c(2006,0.457 ,0.626, 0.672, 0.685),
c(2007, 0.482, 0.636, 0.681, 0.711),
c(2008, 0.365, 0.538, 0.703, 0.712)
)
mean_LGD_for_data
mean_LGD_for_data <- as.data.frame(
cbind(
c('Indsutry', 'Sr. Sec.', 'Sr. Unsec.', 'Sr. Sub.' ,'Sub.')),
c(2006,0.457 ,0.626, 0.672, 0.685),
c(2007, 0.482, 0.636, 0.681, 0.711),
c(2008, 0.365, 0.538, 0.703, 0.712)
)
mean_LGD_for_data.T
mean_LGD_for_data <- as.data.frame(
cbind(
c('Indsutry', 'Sr. Sec.', 'Sr. Unsec.', 'Sr. Sub.' ,'Sub.')),
c(2006,0.457 ,0.626, 0.672, 0.685),
c(2007, 0.482, 0.636, 0.681, 0.711),
c(2008, 0.365, 0.538, 0.703, 0.712)
)
mean_LGD_for_data
mean_LGD_for_data <- as.data.frame(
cbind(
c('Indsutry', 'Sr. Sec.', 'Sr. Unsec.', 'Sr. Sub.' ,'Sub.'),
c(2006,0.457 ,0.626, 0.672, 0.685),
c(2007, 0.482, 0.636, 0.681, 0.711),
c(2008, 0.365, 0.538, 0.703, 0.712)
)
mean_LGD_for_data
mean_LGD_for_data <- as.data.frame(
cbind(
c('Indsutry', 'Sr. Sec.', 'Sr. Unsec.', 'Sr. Sub.' ,'Sub.'),
c(2006,0.457 ,0.626, 0.672, 0.685),
c(2007, 0.482, 0.636, 0.681, 0.711),
c(2008, 0.365, 0.538, 0.703, 0.712)
)
)
mean_LGD_for_data
mean_LGD_for_data <- as.data.frame(
cbind(
c('Indsutry', 'Sr. Sec.', 'Sr. Unsec.', 'Sr. Sub.' ,'Sub.'),
c(2006,0.457 ,0.626, 0.672, 0.685),
c(2007, 0.482, 0.636, 0.681, 0.711),
c(2008, 0.365, 0.538, 0.703, 0.712)
)
header=TRUE
mean_LGD_for_data <- as.data.frame(
cbind(
c('Indsutry', 'Sr. Sec.', 'Sr. Unsec.', 'Sr. Sub.' ,'Sub.'),
c(2006,0.457 ,0.626, 0.672, 0.685),
c(2007, 0.482, 0.636, 0.681, 0.711),
c(2008, 0.365, 0.538, 0.703, 0.712)
)
head=TRUE
mean_LGD_for_data <- as.data.frame(
cbind(
c('Indsutry', 'Sr. Sec.', 'Sr. Unsec.', 'Sr. Sub.' ,'Sub.'),
c(2006,0.457 ,0.626, 0.672, 0.685),
c(2007, 0.482, 0.636, 0.681, 0.711),
c(2008, 0.365, 0.538, 0.703, 0.712)
),
head=TRUE
)
mean_LGD_for_data
mean_LGD_for_data <- as.data.frame(
cbind(
c('Indsutry', 'Sr. Sec.', 'Sr. Unsec.', 'Sr. Sub.' ,'Sub.'),
c(2006,0.457 ,0.626, 0.672, 0.685),
c(2007, 0.482, 0.636, 0.681, 0.711),
c(2008, 0.365, 0.538, 0.703, 0.712)
),
head=c('Industry',2006,2007,2008)
)
mean_LGD_for_data
mean_LGD_for_data <- as.data.frame(read.csv('mean_LGD.csv',header = TRUE))
mean_LGD_for_data
lgd_modified <- read.csv("lgd_modifed.csv",header = TRUE)
lgd_modified <- read.csv("lgd_modified.csv",header = TRUE)
lgd_modified
lgd_modified <- read.csv("lgd_modified.csv",header = TRUE)
head(lgd_modified$LGD_A)
lgd_modified <- read.csv("lgd_modified.csv",header = TRUE)
tail(lgd_modified$LGD_A)
View(lgd_modified)
View(lgd_modified)
head(lgd_modified$I_DEF)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF)
summary(regression)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF)
summary(regression)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF)
summary(regression)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF)
summary(regression)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF)
summary(regression)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
lm.cluster()
library(miceadds)
library(miceadds)
install.packages('miceadds')
library(miceadds)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
lm.cluster()
library(miceadds)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
lm.cluster(data = lgd_modified,cluster = lgd_modified$ID)
library(miceadds)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
lm.cluster(data = lgd_modified,formula = LGD~LEV+LGD_A,I_DEF,cluster = lgd_modified$ID)
# regression <- lm(LGD~LEV+LGD_A+I_DEF)
# summary(regression)
library(miceadds)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
lm.cluster(data = lgd_modified,formula = LGD~LEV+LGD_A+I_DEF,cluster = lgd_modified$ID)
# regression <- lm(LGD~LEV+LGD_A+I_DEF)
# summary(regression)
library(miceadds)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF)
summary(regression)
library(miceadds)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
lm.cluster(data = lgd_modified,formula = LGD~LEV+LGD_A+I_DEF,cluster = lgd_modified$ID)
# regression <- lm(LGD~LEV+LGD_A+I_DEF)
# summary(regression)
library(miceadds)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
lm.cluster(data = lgd_modified,formula = LGD~LEV+LGD_A+I_DEF,cluster = lgd_modified$ID)
regression <- lm(LGD~LEV+LGD_A+I_DEF)
summary(regression)
library(miceadds)
library(clubSandwich)
install.packages('clubSandwich')
library(miceadds)
library(clubSandwich)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF)
summary(regression)
coef_test(regression, vcov = "CR2",
cluster = lgd_modified$ID, test = "Satterthwaite")[1:2,]
coef_test(regression, vcov = "CR2",
cluster = lgd_modified$ID, test = "Satterthwaite")
coef_test(regression, vcov = "CR2",
cluster = lgd_modified$ID, test = "naive-t")
library(miceadds)
library(clubSandwich)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
regression <- glm(LGD~LEV+LGD_A+I_DEF)
summary(regression)
library(miceadds)
library(clubSandwich)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF)
summary(regression)
library(miceadds)
library(clubSandwich)
LGD <- lgd_modified$LGD
LEV <- lgd_modified$LEV
LGD_A <- lgd_modified$LGD_A
I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF,data = lgd_modified)
summary(regression)
library(miceadds)
library(clubSandwich)
# LGD <- lgd_modified$LGD
# LEV <- lgd_modified$LEV
# LGD_A <- lgd_modified$LGD_A
# I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF,data = lgd_modified)
summary(regression)
# LGD <- lgd_modified$LGD
# LEV <- lgd_modified$LEV
# LGD_A <- lgd_modified$LGD_A
# I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF,data = lgd_modified)
summary(regression)
spd <- read.csv('spd.csv')
spd <- data.frame(
year = spd$year.t,
Dt = spd$X..defaults..Dt.,
Nt = spd$X..obligors..Nt.
)
spd
spd = cbind(spd,pt = spd$Dt/spd$Nt)
spd
average_default_prob <- sum(spd$pt)/length(spd$year)
average_default_prob
spd = cbind(spd,p2 = (spd$Dt*(spd$Dt-1))/(spd$Nt*(spd$Nt-1)))
spd
average_joint_default_prob <- sum(spd$p2)/length(spd$year)
average_joint_default_prob
d <- qnorm(sum(spd$pt)/length(spd$year))
d
library(rootSolve)
library(pbivnorm)
f <- function(rho){pbivnorm(d,d,rho) - average_joint_default_prob}
uniroot(f,c(0,1))$root
lgd <- as.data.frame(read.csv('lgd.csv'))
lgd
lgd_modified <- read.csv("lgd_modified.csv",header = TRUE)
tail(lgd_modified$LGD_A)
head(lgd_modified$I_DEF)
# LGD <- lgd_modified$LGD
# LEV <- lgd_modified$LEV
# LGD_A <- lgd_modified$LGD_A
# I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF,data = lgd_modified)
summary(regression)
new_data <- as.data.frame(
LEV =
)
spd <- read.csv('spd.csv')
spd <- data.frame(
year = spd$year.t,
Dt = spd$X..defaults..Dt.,
Nt = spd$X..obligors..Nt.
)
spd
spd = cbind(spd,pt = spd$Dt/spd$Nt)
spd
average_default_prob <- sum(spd$pt)/length(spd$year)
average_default_prob
spd = cbind(spd,p2 = (spd$Dt*(spd$Dt-1))/(spd$Nt*(spd$Nt-1)))
spd
average_joint_default_prob <- sum(spd$p2)/length(spd$year)
average_joint_default_prob
d <- qnorm(sum(spd$pt)/length(spd$year))
d
library(rootSolve)
library(pbivnorm)
f <- function(rho){pbivnorm(d,d,rho) - average_joint_default_prob}
uniroot(f,c(0,1))$root
lgd <- as.data.frame(read.csv('lgd.csv'))
lgd
lgd_modified <- read.csv("lgd_modified.csv",header = TRUE)
tail(lgd_modified$LGD_A)
head(lgd_modified$I_DEF)
# LGD <- lgd_modified$LGD
# LEV <- lgd_modified$LEV
# LGD_A <- lgd_modified$LGD_A
# I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF,data = lgd_modified)
summary(regression)
new_data <- as.data.frame(
LEV =
)
new_data <- as.data.frame(
LEV = c(0.607452818682007),
LGD_A = c(0.365),
I_DEF = c(3.783)
)
new_data <- as.data.frame(
LEV = c(0.607452818682007),
LGD_A = c(0.365),
I_DEF = c(3.783)
)
new_data <- as.data.frame(
cbind(
LEV = c(0.607452818682007),
LGD_A = c(0.365),
I_DEF = c(3.783))
)
new_data
# predict(regression,)
new_data <- as.data.frame(
cbind(
LEV = c(0.607452818682007),
LGD_A = c(0.365),
I_DEF = c(3.783))
)
# new_data
predict(regression,data=new_data)
new_data <- as.data.frame(
cbind(
LEV = c(0.607452818682007),
LGD_A = c(0.365),
I_DEF = c(3.783))
)
# new_data
predict(regression,newdata=new_data)
LGD <- lgd_modified$LGD
a=mean(LGD)/var(LGD)*(mean(LGD)*(1-mean(LGD))-var(LGD))
b=(1-mean(LGD))/var(LGD)*(mean(LGD)*(1-mean(LGD))-var(LGD))
LGD <- lgd_modified$LGD
a=mean(LGD)/var(LGD)*(mean(LGD)*(1-mean(LGD))-var(LGD))
b=(1-mean(LGD))/var(LGD)*(mean(LGD)*(1-mean(LGD))-var(LGD))
u=pbeta(LGD, a,b)
hist(u)
a
b
print(a)
print("_______________________________")
print(b)
LGD <- lgd_modified$LGD
a=mean(LGD)/var(LGD)*(mean(LGD)*(1-mean(LGD))-var(LGD))
b=(1-mean(LGD))/var(LGD)*(mean(LGD)*(1-mean(LGD))-var(LGD))
# u=pbeta(LGD, a,b)
# hist(u)
lgd_t <- as.data.frame(
cbind(
lgd_modified,
TLGD=qnorm(pbeta(LGD, a,b))
)
)
lgd_t
lgd_t <- as.data.frame(
cbind(
lgd_modified,
TLGD=qnorm(pbeta(LGD, a,b))
)
)
# lgd_t
regression_normal <- lm(TLGD~LEV+LGD_A+I_DEF)
lgd_t <- as.data.frame(
cbind(
lgd_modified,
TLGD=qnorm(pbeta(LGD, a,b))
)
)
# lgd_t
regression_normal <- lm(TLGD~LEV+LGD_A+I_DEF,data = lgd_t)
summary(regression_normal)
#predict
tlgd_pred <- predict(regression_normal,newdata=new_data)
#transform original scale
tlgd_pred
#predict
tlgd_pred <- predict(regression_normal,newdata=new_data)
#transform original scale
# tlgd_pred
bLGD=qbeta(pnorm(tlgd_pred),a,b)
bLGD
spd <- read.csv('spd.csv')
spd <- data.frame(
year = spd$year.t,
Dt = spd$X..defaults..Dt.,
Nt = spd$X..obligors..Nt.
)
spd
spd = cbind(spd,pt = spd$Dt/spd$Nt)
spd
average_default_prob <- sum(spd$pt)/length(spd$year)
average_default_prob
spd = cbind(spd,p2 = (spd$Dt*(spd$Dt-1))/(spd$Nt*(spd$Nt-1)))
spd
average_joint_default_prob <- sum(spd$p2)/length(spd$year)
average_joint_default_prob
d <- qnorm(sum(spd$pt)/length(spd$year))
d
library(rootSolve)
library(pbivnorm)
f <- function(rho){pbivnorm(d,d,rho) - average_joint_default_prob}
uniroot(f,c(0,1))$root
lgd <- as.data.frame(read.csv('lgd.csv'))
lgd
lgd_modified <- read.csv("lgd_modified.csv",header = TRUE)
tail(lgd_modified$LGD_A)
head(lgd_modified$I_DEF)
# LGD <- lgd_modified$LGD
# LEV <- lgd_modified$LEV
# LGD_A <- lgd_modified$LGD_A
# I_DEF <- lgd_modified$I_DEF
regression <- lm(LGD~LEV+LGD_A+I_DEF,data = lgd_modified)
summary(regression)
new_data <- as.data.frame(
cbind(
LEV = c(0.607452818682007),
LGD_A = c(0.365),
I_DEF = c(3.783))
)
# new_data
predict(regression,newdata=new_data)
LGD <- lgd_modified$LGD
a=mean(LGD)/var(LGD)*(mean(LGD)*(1-mean(LGD))-var(LGD))
b=(1-mean(LGD))/var(LGD)*(mean(LGD)*(1-mean(LGD))-var(LGD))
# u=pbeta(LGD, a,b)
# hist(u)
lgd_t <- as.data.frame(
cbind(
lgd_modified,
TLGD=qnorm(pbeta(LGD, a,b))
)
)
# lgd_t
regression_normal <- lm(TLGD~LEV+LGD_A+I_DEF,data = lgd_t)
summary(regression_normal)
#predict
tlgd_pred <- predict(regression_normal,newdata=new_data)
#transform original scale
bLGD=qbeta(pnorm(tlgd_pred),a,b)
bLGD
